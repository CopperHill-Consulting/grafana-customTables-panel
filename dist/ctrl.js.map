{"version":3,"sources":["../src/ctrl.js"],"names":["DEFAULT_PSEUDO_CSS","CONTENT_RULE_TYPES","id","text","CONTENT_RULE_CLASS_LEVELS","CONTENT_RULE_MIN_MAX_VALUE_OPS","CONTENT_RULE_EXACT_NUM_OPS","DEFAULT_PANEL_SETTINGS","pseudoCSS","JSON","stringify","columnDefs","isFullWidth","allowOrdering","allowSearching","allowLengthChange","parseRegExp","strPattern","parts","exec","RegExp","_","escapeRegExp","setContent","jElem","ctrl","data","panel","height","tableOpts","cls","style","width","table","JS","dom","jTable","jQuery","appendTo","html","options","rows","columns","columnTexts","map","title","result","colDefs","i","l","length","colDef","filter","test","display","replace","isVisible","classNames","className","orderable","isOrderable","searchable","isSearchable","visible","scrollY","scrollX","scrollCollapse","ordering","searching","lengthChange","order","pageLength","dataTable","DataTable","find","css","fixDataTableSize","each","elem","trim","appendChild","parse","console","log","jWrap","fullHeight","wrapHeight","jScrollBody","scrollHeight","nonScrollHeight","renderNow","e","error","isValid","jContent","elemContent","type","err","msg","message","elemMsg","alignItems","textAlign","$","margin","append","parseData","col","DataTablePanelCtrl","$scope","$injector","$rootScope","defaultsDeep","events","on","onInitEditMode","bind","onDataReceived","onDataError","path","addEditorTab","dataList","extend","isReal","EXTRA_COLS","concat","range","y","x","Math","random","obj","key","newValue","name","eval","push","contentRules","columnDef","splice","indexOf","classLevel","minValue","maxValue","minValueOp","maxValueOp","exactNum","exactNumOp","url","openNewWindow","contentRule","emit","scope","attrs","call","debounce","MetricsPanelCtrl","templateUrl"],"mappings":"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","sourcesContent":["import {MetricsPanelCtrl} from 'app/plugins/sdk';\nimport _ from 'lodash';\nimport * as JS from './external/YourJS.min';\nimport './external/datatables/js/jquery.dataTables.min';\nimport './external/datatables/js/dataTables.fixedHeader.min';\nimport './external/datatables/css/jquery.dataTables.min.css!';\nimport './external/datatables/css/fixedHeader.dataTables.min.css!';\nimport './external/datatables-grafana-fix.css!';\n\nconst DEFAULT_PSEUDO_CSS = {\n  \".theme-dark &\": {\n    \"color\": \"white\"\n  },\n  \"table.dataTable tbody tr\": {\n    \"&:hover\": {\n      \"background-image\": \"linear-gradient(0deg, rgba(128,128,128,0.05), rgba(128,128,128,0.05))\"\n    },\n    \"&, &.even, &.odd\": {\n      \"background-color\": \"transparent\",\n      \">.sorting_1, >.sorting_2, >.sorting_3\": {\n        \"background-color\": \"transparent\"\n      },\n      \"td\": {\n        \"border-color\": \"transparent\"\n      }\n    },\n    \"&.odd\": {\n      \"background-color\": \"rgba(128,128,128,0.2)\"\n    },\n    \"&.even\": {\n      \"background-color\": \"rgba(128,128,128,0.1)\"\n    }\n  }\n};\n\nconst CONTENT_RULE_TYPES = [\n  { id: 'FILTER', text: 'Filter by exact text or RegExp' },\n  { id: 'EXACT', text: \"Match or don't match a number\" },\n  { id: 'RANGE', text: \"Match a range of values\" }\n];\n\nconst CONTENT_RULE_CLASS_LEVELS = [\n  { id: 'ROW', text: 'Entire row' },\n  { id: 'CELL', text: \"Only the cell\" }\n];\n\nconst CONTENT_RULE_MIN_MAX_VALUE_OPS = [\n  { id: '<', text: '< (less than)' },\n  { id: '<=', text: '\\u2264 (less than or equal to)' },\n  { id: '>=', text: '\\u2265 (greater than or equal to)' },\n  { id: '>', text: '> (greater than)' }\n];\n\nconst CONTENT_RULE_EXACT_NUM_OPS = [\n  { id: '==', text: '= (equals)' },\n  { id: '!=', text: \"\\u2260 (doesn't)\" }\n];\n\nconst DEFAULT_PANEL_SETTINGS = {\n  pseudoCSS: JSON.stringify(DEFAULT_PSEUDO_CSS, null, 2),\n  columnDefs: [],\n  isFullWidth: true,\n  allowOrdering: true,\n  allowSearching: true,\n  allowLengthChange: true\n};\n\nfunction parseRegExp(strPattern) {\n  let parts = /^\\/(.+)\\/(\\w*)$/.exec(strPattern);\n  return parts ? new RegExp(parts[1], parts[2]) : new RegExp('^' + _.escapeRegExp(strPattern) + '$', 'i');\n}\n\nfunction setContent(jElem, ctrl) {\n  let data = ctrl.data;\n  let panel = ctrl.panel;\n  let height = jElem.height();\n\n  let tableOpts = { _: 'table', cls: 'display', style: {} };\n  if (panel.isFullWidth) {\n    tableOpts.style.width = '100%';\n  }\n\n  let table = JS.dom(tableOpts);\n  let jTable = jQuery(table).appendTo(jElem.html(''));\n  let options = {\n    data: data.rows,\n    columns: data.columnTexts.map(title => {\n      let result = { title };\n\n      for (let colDefs = panel.columnDefs, i = 0, l = colDefs.length; i < l; i++) {\n        let colDef = colDefs[i];\n        let filter = parseRegExp(colDef.filter);\n        if (filter.test(title)) {\n          if (colDef.display) {\n            result.title = title.replace(filter, colDef.display);\n          }\n          if (colDef.isVisible) {\n            if (colDef.width) {\n              result.width = colDef.width;\n            }\n            if (colDef.classNames) {\n              result.className = colDef.classNames;\n            }\n            result.orderable = colDef.isOrderable;\n            result.searchable = colDef.isSearchable;\n          }\n          else {\n            result.visible = colDef.isVisible;\n          }\n          break;\n        }\n      }\n\n      return result;\n    }),\n    scrollY: height,\n    scrollX: true,\n    scrollCollapse: true,\n    ordering: panel.allowOrdering,\n    searching: panel.allowSearching,\n    lengthChange: panel.allowLengthChange,\n    order: [],\n    pageLength: 50\n  };\n  let dataTable = jTable.DataTable(options);\n\n  jElem.find('.dataTables_scrollHeadInner').css('margin', '0 auto');\n  fixDataTableSize(jElem.find('.dataTables_wrapper'), height);\n\n  jElem.each((i, elem) => {\n    elem.className = elem.className.replace(/\\b_\\d+\\b/g, ' ').replace(/\\s+/g, ' ').trim();\n    elem.appendChild(JS.css(JSON.parse(panel.pseudoCSS), elem));\n  });\n\n  console.log({ data, height, ctrl, jElem, jTable, dataTable, options, table });\n}\n\nfunction fixDataTableSize(jWrap, fullHeight) {\n  let wrapHeight = jWrap.height();\n  let jScrollBody = jWrap.find('.dataTables_scrollBody');\n  let scrollHeight = jScrollBody.height();\n  let nonScrollHeight = wrapHeight - scrollHeight;\n  jScrollBody.css('max-height', fullHeight - nonScrollHeight);\n}\n\nfunction renderNow(e, jElem) {\n  let error,\n      isValid = false,\n      ctrl = this,\n      data = ctrl.data,\n      jContent = jElem.find('.panel-content').css('position', 'relative').html(''),\n      elemContent = jContent[0];\n  \n  if (data && data.rows.length) {\n    if (data.type === 'table') {\n      try {\n        setContent(jContent, ctrl);\n        isValid = true;\n      }\n      catch (err) {\n        error = err;\n      }\n    }\n  }\n  if (!isValid) {\n    let msg = 'No data' + (error ? ':  \\r\\n' + error.message : '.');\n    let elemMsg = JS.dom({ _: 'div', style: { display: 'flex', alignItems: 'center', textAlign: 'center', height: '100%' }, $: [\n      { _: 'div', cls: 'alert alert-error', style: { margin: '0px auto' }, text: msg }\n    ]});\n    jContent.html('').append(elemMsg);\n  }\n}\n\nfunction parseData(columns, rows) {\n  return {\n    columns,\n    rows,\n    columnTexts: columns.map(col => 'string' === typeof col ? col : col.text)\n  };\n}\n\nexport class DataTablePanelCtrl extends MetricsPanelCtrl {\n  constructor($scope, $injector, $rootScope) {\n    super($scope, $injector);\n\n    this.$rootScope = $rootScope;\n    this.data = null;\n\n    _.defaultsDeep(this.panel, DEFAULT_PANEL_SETTINGS);\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n  }\n\n  onInitEditMode() {\n    let path = 'public/plugins/copperhill-datatables-panel/partials/';\n    this.addEditorTab('Options', `${path}editor.html`, 2);\n    this.addEditorTab('Column Definitions', `${path}column-defs.html`, 3);\n    this.addEditorTab('Styles', `${path}styles.html`, 4);\n  }\n\n  onDataError() {\n    this.renderNow();\n  }\n\n  onDataReceived(dataList) {\n    if (dataList && dataList.length) {\n      let data = dataList[0];\n      this.data = _.extend(\n        parseData(data.columns, data.rows),\n        { isReal: true, type: data.type }\n      );\n    }\n    else {\n      let EXTRA_COLS = 2;\n      this.data = _.extend(\n        parseData(\n          [{ text: \"X\" }, { text: \"X * X\" }, { text: \"X + X\" }].concat(_.range(EXTRA_COLS).map(y => ({ text: `${y} / Math.random()`}))),\n          _.range(150).map(x => [x, x * x, x + x].concat(_.range(EXTRA_COLS).map(y => y / Math.random())))\n        ),\n        { isReal: false, type: 'table' }\n      );\n    }\n\n    this.renderNow();\n  }\n\n  onChangeCallback(obj, key) {\n    return newValue => {\n      obj[key] = newValue;\n      this.renderNow();\n    };\n  }\n\n  getConstByName(name) {\n    if (/^[A-Z_][A-Z_0-9]*$/.test(name)) {\n     return eval(name);\n    }\n  }\n\n  addColumnDef() {\n    this.panel.columnDefs.push({\n      filter: '/[^]*/',\n      display: '',\n      width: '',\n      classNames: '',\n      isVisible: true,\n      isOrderable: true,\n      isSearchable: true,\n      contentRules: []\n    });\n  }\n\n  removeColumnDef(columnDef) {\n    let columnDefs = this.panel.columnDefs;\n    columnDefs.splice(columnDefs.indexOf(columnDef), 1);\n  }\n\n  addColumnContentRule(columnDef) {\n    columnDef.contentRules.push({\n      type: CONTENT_RULE_TYPES[0].id,\n      classNames: '',\n      classLevel: CONTENT_RULE_CLASS_LEVELS[0].id,\n      filter: '',\n      display: '',\n      minValue: null,\n      maxValue: null,\n      minValueOp: null,\n      maxValueOp: null,\n      exactNum: null,\n      exactNumOp: null,\n      url: '',\n      openNewWindow: true\n    });\n  }\n\n  removeColumnContentRule(contentRule, columnDef) {\n    let contentRules = columnDef.contentRules;\n    contentRules.splice(contentRules.indexOf(contentRule), 1);\n  }\n\n  renderNow(e, elem) {\n    this.events.emit('renderNow');\n  }\n\n  renderAfterOneSec() {\n    this.events.emit('renderAfterOneSec');\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    this.events.on('renderNow', e => renderNow.call(this, e, elem));\n    this.events.on('render', _.debounce(e => renderNow.call(this, e, elem), 250));\n    this.events.on('renderAfterOneSec', _.debounce(e => renderNow.call(this, e, elem), 1000));\n  }\n}\n\nDataTablePanelCtrl.templateUrl = 'partials/module.html';\n"],"file":"ctrl.js"}