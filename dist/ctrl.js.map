{"version":3,"sources":["../src/ctrl.js"],"names":["RGX_SIMPLE_NUMBER","DEFAULT_PSEUDO_CSS","CONTENT_RULE_TYPES","id","text","CONTENT_RULE_CLASS_LEVELS","CONTENT_RULE_MAX_VALUE_OPS","CONTENT_RULE_MIN_VALUE_OPS","CONTENT_RULE_EXACT_NUM_OPS","DEFAULT_PANEL_SETTINGS","pseudoCSS","JSON","stringify","columnDefs","isFullWidth","allowOrdering","allowSearching","allowLengthChange","parseRegExp","strPattern","parts","exec","RegExp","_","escapeRegExp","setContent","jElem","ctrl","data","panel","height","tableOpts","cls","style","width","table","JS","dom","jTable","jQuery","appendTo","html","colDefs","colDefRgxs","map","colDef","filter","colDefIndexByCol","columnTexts","title","reduce","carry","colDefRgx","colDefIndex","test","colDefContentRuleFilters","contentRules","rule","type","options","rows","columns","colIndex","result","display","replace","isVisible","classNames","className","orderable","isOrderable","searchable","isSearchable","visible","scrollY","scrollX","scrollCollapse","ordering","searching","lengthChange","order","pageLength","rowCallback","tr","rowData","tdIndex","cell","rules","forEach","ruleIndex","isMatch","minValue","maxValue","minValueOp","maxValueOp","negateCriteria","classLevel","addClass","eq","console","log","dataTable","DataTable","find","css","fixDataTableSize","each","i","elem","trim","appendChild","parse","jWrap","fullHeight","wrapHeight","jScrollBody","scrollHeight","nonScrollHeight","renderNow","e","error","isValid","jContent","elemContent","length","err","msg","message","elemMsg","alignItems","textAlign","$","margin","append","parseData","col","DataTablePanelCtrl","$scope","$injector","$rootScope","defaultsDeep","events","on","onInitEditMode","bind","onDataReceived","onDataError","path","addEditorTab","dataList","extend","isReal","EXTRA_COLS","concat","range","y","x","Math","random","obj","key","newValue","name","eval","push","columnDef","splice","indexOf","url","openNewWindow","contentRule","emit","scope","attrs","call","debounce","MetricsPanelCtrl","templateUrl"],"mappings":"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","sourcesContent":["import {MetricsPanelCtrl} from 'app/plugins/sdk';\nimport _ from 'lodash';\nimport * as JS from './external/YourJS.min';\nimport './external/datatables/js/jquery.dataTables.min';\nimport './external/datatables/js/dataTables.fixedHeader.min';\nimport './external/datatables/css/jquery.dataTables.min.css!';\nimport './external/datatables/css/fixedHeader.dataTables.min.css!';\nimport './external/datatables-grafana-fix.css!';\n\nconst RGX_SIMPLE_NUMBER = /^\\d+(\\.\\d+)?$/;\n\nconst DEFAULT_PSEUDO_CSS = {\n  \".theme-dark &\": {\n    \"color\": \"white\"\n  },\n  \"table.dataTable tbody tr\": {\n    \"&:hover\": {\n      \"background-image\": \"linear-gradient(0deg, rgba(128,128,128,0.05), rgba(128,128,128,0.05))\"\n    },\n    \"&, &.even, &.odd\": {\n      \"background-color\": \"transparent\",\n      \">.sorting_1, >.sorting_2, >.sorting_3\": {\n        \"background-color\": \"transparent\"\n      },\n      \"td\": {\n        \"border-color\": \"transparent\"\n      }\n    },\n    \"&.odd\": {\n      \"background-color\": \"rgba(128,128,128,0.2)\"\n    },\n    \"&.even\": {\n      \"background-color\": \"rgba(128,128,128,0.1)\"\n    }\n  }\n};\n\nconst CONTENT_RULE_TYPES = [\n  { id: 'FILTER', text: 'Filter by exact value or RegExp' },\n  { id: 'RANGE', text: \"Match a range of values\" },\n  { id: 'NULL', text: \"Is NULL\" }\n];\n\nconst CONTENT_RULE_CLASS_LEVELS = [\n  { id: 'CELL', text: \"Only the cell\" },\n  { id: 'ROW', text: 'Entire row' }\n];\n\nconst CONTENT_RULE_MAX_VALUE_OPS = [\n  { id: '', text: '' },\n  { id: '>=', text: '\\u2265 (greater than or equal to)' },\n  { id: '>', text: '> (greater than)' }\n];\n\nconst CONTENT_RULE_MIN_VALUE_OPS = [\n  { id: '', text: '' },\n  { id: '<', text: '< (less than)' },\n  { id: '<=', text: '\\u2264 (less than or equal to)' }\n];\n\nconst CONTENT_RULE_EXACT_NUM_OPS = [\n  { id: '==', text: '= (equals)' },\n  { id: '!=', text: \"\\u2260 (doesn't)\" }\n];\n\nconst DEFAULT_PANEL_SETTINGS = {\n  pseudoCSS: JSON.stringify(DEFAULT_PSEUDO_CSS, null, 2),\n  columnDefs: [],\n  isFullWidth: true,\n  allowOrdering: true,\n  allowSearching: true,\n  allowLengthChange: true\n};\n\nfunction parseRegExp(strPattern) {\n  let parts = /^\\/(.+)\\/(\\w*)$/.exec(strPattern);\n  return parts ? new RegExp(parts[1], parts[2]) : new RegExp('^' + _.escapeRegExp(strPattern) + '$', 'i');\n}\n\nfunction setContent(jElem, ctrl) {\n  let data = ctrl.data;\n  let panel = ctrl.panel;\n  let height = jElem.height();\n\n  let tableOpts = { _: 'table', cls: 'display', style: {} };\n  if (panel.isFullWidth) {\n    tableOpts.style.width = '100%';\n  }\n\n  let table = JS.dom(tableOpts);\n  let jTable = jQuery(table).appendTo(jElem.html(''));\n  let colDefs = panel.columnDefs;\n  let colDefRgxs = colDefs.map(colDef => parseRegExp(colDef.filter));\n  let colDefIndexByCol = data.columnTexts.map(\n    title => colDefRgxs.reduce(\n      (carry, colDefRgx, colDefIndex) => (carry < 0 && colDefRgx.test(title)) ? colDefIndex : carry,\n      -1\n    )\n  );\n  let colDefContentRuleFilters = colDefs.map(\n    colDef => colDef.contentRules.map(\n      rule => rule.type === 'FILTER' ? parseRegExp(rule.filter) : null\n    )\n  );\n  let options = {\n    data: data.rows,\n    columns: data.columnTexts.map((title, colIndex) => {\n      let result = { title };\n\n      let colDefIndex = colDefIndexByCol[colIndex];\n      let colDef = colDefs[colDefIndex];\n      if (colDef) {\n        let filter = colDefRgxs[colDefIndex];\n        if (filter.test(title)) {\n          if (colDef.display) {\n            result.title = title.replace(filter, colDef.display);\n          }\n          if (colDef.isVisible) {\n            if (colDef.width) {\n              result.width = colDef.width;\n            }\n            if (colDef.classNames) {\n              result.className = colDef.classNames;\n            }\n            result.orderable = colDef.isOrderable;\n            result.searchable = colDef.isSearchable;\n          }\n          else {\n            result.visible = colDef.isVisible;\n          }\n        }\n      }\n\n      return result;\n    }),\n    scrollY: height,\n    scrollX: true,\n    scrollCollapse: true,\n    ordering: panel.allowOrdering,\n    searching: panel.allowSearching,\n    lengthChange: panel.allowLengthChange,\n    order: [],\n    pageLength: 5,\n    rowCallback: function(tr, rowData) {\n      let tdIndex = -1;\n      rowData.map((cell, colIndex) => {\n        let colDefIndex = colDefIndexByCol[colIndex];\n        let colDef = colDefs[colDefIndex];\n\n        if (!colDef || colDef.isVisible) {\n          tdIndex++;\n        }\n\n        if (colDef) {\n          if (colDef.isVisible) {\n            let rules = colDef.contentRules;\n            rules.forEach((rule, ruleIndex) => {\n              let isMatch = true;\n              let type = rule.type;\n              if (type === 'FILTER') {\n                isMatch = colDefContentRuleFilters[colDefIndex][ruleIndex].test(cell);\n              }\n              else if (type === 'RANGE') {\n                let minValue = rule.minValue;\n                if (RGX_SIMPLE_NUMBER.test(minValue)) {\n                  minValue = +minValue;\n                }\n                let maxValue = rule.maxValue;\n                if (RGX_SIMPLE_NUMBER.test(maxValue)) {\n                  maxValue = +maxValue;\n                }\n                let minValueOp = rule.minValueOp;\n                if (minValueOp) {\n                  isMatch = isMatch && (minValueOp === '<=' ? minValue <= cell : (minValue < cell));\n                }\n                let maxValueOp = rule.maxValueOp;\n                if (maxValueOp) {\n                  isMatch = isMatch && (maxValueOp === '>=' ? maxValue >= cell : (maxValue > cell));\n                }\n              }\n              else {\n                isMatch = cell == null;\n              }\n\n              isMatch = isMatch !== rule.negateCriteria;\n\n              // If this is a match apply the class(es)\n              if (isMatch) {\n                if (rule.classNames) {\n                  if (rule.classLevel === 'ROW') {\n                    jQuery(tr).addClass(rule.classNames);\n                  }\n                  else {\n                    jQuery('>td', tr).eq(tdIndex).addClass(rule.classNames);\n                    console.log(192, { tr, cell, rowData, rule, colDef });\n                  }\n                }\n              }\n            });\n          }\n        }\n      });\n    }\n  };\n  let dataTable = jTable.DataTable(options);\n\n  jElem.find('.dataTables_scrollHeadInner').css('margin', '0 auto');\n  fixDataTableSize(jElem.find('.dataTables_wrapper'), height);\n\n  jElem.each((i, elem) => {\n    elem.className = elem.className.replace(/\\b_\\d+\\b/g, ' ').replace(/\\s+/g, ' ').trim();\n    elem.appendChild(JS.css(JSON.parse(panel.pseudoCSS), elem));\n  });\n\n  console.log({ colDefRgxs, colDefIndexByCol });\n}\n\nfunction fixDataTableSize(jWrap, fullHeight) {\n  let wrapHeight = jWrap.height();\n  let jScrollBody = jWrap.find('.dataTables_scrollBody');\n  let scrollHeight = jScrollBody.height();\n  let nonScrollHeight = wrapHeight - scrollHeight;\n  jScrollBody.css('max-height', fullHeight - nonScrollHeight);\n}\n\nfunction renderNow(e, jElem) {\n  let error,\n      isValid = false,\n      ctrl = this,\n      data = ctrl.data,\n      jContent = jElem.find('.panel-content').css('position', 'relative').html(''),\n      elemContent = jContent[0];\n  \n  if (data && data.rows.length) {\n    if (data.type === 'table') {\n      try {\n        setContent(jContent, ctrl);\n        isValid = true;\n      }\n      catch (err) {\n        error = err;\n      }\n    }\n  }\n  if (!isValid) {\n    let msg = 'No data' + (error ? ':  \\r\\n' + error.message : '.');\n    let elemMsg = JS.dom({ _: 'div', style: { display: 'flex', alignItems: 'center', textAlign: 'center', height: '100%' }, $: [\n      { _: 'div', cls: 'alert alert-error', style: { margin: '0px auto' }, text: msg }\n    ]});\n    jContent.html('').append(elemMsg);\n  }\n}\n\nfunction parseData(columns, rows) {\n  return {\n    columns,\n    rows,\n    columnTexts: columns.map(col => 'string' === typeof col ? col : col.text)\n  };\n}\n\nexport class DataTablePanelCtrl extends MetricsPanelCtrl {\n  constructor($scope, $injector, $rootScope) {\n    super($scope, $injector);\n\n    this.$rootScope = $rootScope;\n    this.data = null;\n\n    _.defaultsDeep(this.panel, DEFAULT_PANEL_SETTINGS);\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n  }\n\n  onInitEditMode() {\n    let path = 'public/plugins/copperhill-datatables-panel/partials/';\n    this.addEditorTab('Options', `${path}editor.html`, 2);\n    this.addEditorTab('Column Definitions', `${path}column-defs.html`, 3);\n    this.addEditorTab('Styles', `${path}styles.html`, 4);\n  }\n\n  onDataError() {\n    this.renderNow();\n  }\n\n  onDataReceived(dataList) {\n    if (dataList && dataList.length) {\n      let data = dataList[0];\n      this.data = _.extend(\n        parseData(data.columns, data.rows),\n        { isReal: true, type: data.type }\n      );\n    }\n    else {\n      let EXTRA_COLS = 2;\n      this.data = _.extend(\n        parseData(\n          [{ text: \"X\" }, { text: \"X * X\" }, { text: \"X + X\" }].concat(_.range(EXTRA_COLS).map(y => ({ text: `${y} / Math.random()`}))),\n          _.range(150).map(x => [x, x * x, x + x].concat(_.range(EXTRA_COLS).map(y => y / Math.random())))\n        ),\n        { isReal: false, type: 'table' }\n      );\n    }\n\n    this.renderNow();\n  }\n\n  onChangeCallback(obj, key) {\n    return newValue => {\n      obj[key] = newValue;\n      this.renderNow();\n    };\n  }\n\n  getConstByName(name) {\n    if (/^[A-Z_][A-Z_0-9]*$/.test(name)) {\n     return eval(name);\n    }\n  }\n\n  addColumnDef() {\n    this.panel.columnDefs.push({\n      filter: '/[^]*/',\n      display: '',\n      width: '',\n      classNames: '',\n      isVisible: true,\n      isOrderable: true,\n      isSearchable: true,\n      contentRules: []\n    });\n  }\n\n  removeColumnDef(columnDef) {\n    let columnDefs = this.panel.columnDefs;\n    columnDefs.splice(columnDefs.indexOf(columnDef), 1);\n  }\n\n  addColumnContentRule(columnDef) {\n    columnDef.contentRules.push({\n      type: CONTENT_RULE_TYPES[0].id,\n      classNames: '',\n      classLevel: CONTENT_RULE_CLASS_LEVELS[0].id,\n      filter: '',\n      negateCriteria: false,\n      display: '',\n      minValue: null,\n      maxValue: null,\n      minValueOp: null,\n      maxValueOp: null,\n      url: '',\n      openNewWindow: true\n    });\n  }\n\n  removeColumnContentRule(contentRule, columnDef) {\n    let contentRules = columnDef.contentRules;\n    contentRules.splice(contentRules.indexOf(contentRule), 1);\n  }\n\n  renderNow(e, elem) {\n    this.events.emit('renderNow');\n  }\n\n  renderAfterOneSec() {\n    this.events.emit('renderAfterOneSec');\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    this.events.on('renderNow', e => renderNow.call(this, e, elem));\n    this.events.on('render', _.debounce(e => renderNow.call(this, e, elem), 250));\n    this.events.on('renderAfterOneSec', _.debounce(e => renderNow.call(this, e, elem), 1000));\n  }\n}\n\nDataTablePanelCtrl.templateUrl = 'partials/module.html';\n"],"file":"ctrl.js"}